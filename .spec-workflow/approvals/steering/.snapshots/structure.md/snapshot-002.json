{
  "id": "snapshot_1762961103439_3p3nz0qbv",
  "approvalId": "approval_1762960726187_slhk3ui7c",
  "approvalTitle": "Structure Steering Document",
  "version": 2,
  "timestamp": "2025-11-12T15:25:03.439Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Structure Steering Document: kube-ingress-dash\n\n## Project Structure Convention\n\n```\nkube-ingress-dash/\n├── src/                           # Source code\n│   ├── app/                      # Next.js App Router (or pages/ for Pages Router)\n│   │   ├── layout.tsx            # Root layout with theme provider\n│   │   ├── page.tsx              # Main dashboard page\n│   │   ├── globals.css           # Global styles\n│   │   └── api/                  # API routes\n│   │       └── ingresses/        # Ingress-related API routes\n│   │           └── route.ts      # Main ingress API route\n│   ├── components/               # Reusable UI components\n│   │   ├── ui/                   # shadcn/ui components (auto-generated)\n│   │   ├── ingress-card.tsx      # Ingress visualization component\n│   │   ├── search-bar.tsx        # Search functionality\n│   │   ├── theme-provider.tsx    # Theme context provider\n│   │   └── ...                   # Other UI components\n│   ├── lib/                      # Business logic and utilities\n│   │   ├── k8s/                  # Kubernetes-specific logic\n│   │   │   ├── client.ts         # Kubernetes API client\n│   │   │   ├── ingress-stream.ts # Ingress streaming service\n│   │   │   └── rbac.ts           # RBAC and auth utilities\n│   │   ├── utils/                # General utilities\n│   │   │   ├── ingress-transformer.ts # Data transformation\n│   │   │   ├── error-handler.ts  # Error handling utilities\n│   │   │   └── ...               # Other utilities\n│   │   └── types/                # Type definitions (if not in src/types)\n│   ├── hooks/                    # Custom React hooks\n│   │   ├── use-search.ts         # Search functionality hook\n│   │   ├── use-theme.ts          # Theme management hook\n│   │   └── use-k8s-data.ts       # Kubernetes data fetching hook\n│   └── types/                    # TypeScript type definitions\n│       └── ingress.ts            # Ingress data type definitions\n├── public/                       # Static assets\n├── docs/                         # Documentation\n│   ├── development.md            # Development setup guide\n│   ├── deployment.md             # Deployment instructions\n│   └── architecture.md           # Architecture overview\n├── charts/                       # Helm charts\n│   └── k8s-ingress-dashboard/    # Main Helm chart\n│       ├── Chart.yaml            # Chart metadata\n│       ├── values.yaml           # Default values\n│       ├── templates/            # Kubernetes manifest templates\n│       │   ├── deployment.yaml\n│       │   ├── service.yaml\n│       │   ├── rbac.yaml\n│       │   └── ...               # Other Kubernetes resources\n│       └── README.md             # Chart documentation\n├── tests/                        # Test files (if needed)\n├── .dockerignore                 # Docker ignore file\n├── Dockerfile                    # Multi-stage Dockerfile\n├── next.config.js                # Next.js configuration\n├── tsconfig.json                 # TypeScript configuration\n├── package.json                  # Node.js dependencies and scripts\n├── components.json               # shadcn/ui configuration\n└── README.md                     # Project overview\n```\n\n## Naming Conventions\n\n### File and Directory Naming\n- **Directories**: Use kebab-case (e.g., `k8s-client`, `ui-components`)\n- **Files**: Use kebab-case for most files (e.g., `ingress-card.tsx`, `use-search.ts`)\n- **TypeScript/React Components**: Use PascalCase for component files (e.g., `IngressCard.tsx`)\n- **Test files**: Use `.test.ts` or `.test.tsx` suffix\n- **Configuration files**: Use standard naming (e.g., `next.config.js`, `tsconfig.json`)\n\n### Code Naming\n- **Components**: Use PascalCase (e.g., `IngressCard`, `SearchBar`)\n- **Functions**: Use camelCase (e.g., `getIngresses`, `transformIngressData`)\n- **Variables**: Use camelCase (e.g., `ingressData`, `isConnected`)\n- **Constants**: Use UPPER_SNAKE_CASE (e.g., `DEFAULT_THEME`, `INGRESS_API_PATH`)\n- **Type/Interface Names**: Use PascalCase (e.g., `IngressData`, `ThemeConfig`)\n\n## Component Organization\n\n### UI Components Structure\n```\ncomponents/\n├── ui/                       # shadcn/ui base components (auto-generated)\n│   ├── button.tsx\n│   ├── card.tsx\n│   └── ...\n├── layout/                   # Layout-specific components\n│   └── theme-provider.tsx\n├── data-display/             # Components for displaying data\n│   ├── ingress-card.tsx\n│   └── ingress-grid.tsx\n├── forms/                    # Form and input components\n│   └── search-bar.tsx\n└── utils/                    # Utility components\n    └── error-boundary.tsx\n```\n\n### Hooks Structure\n```\nhooks/\n├── data/                     # Data fetching hooks\n│   └── use-k8s-data.ts\n├── state/                    # State management hooks\n│   ├── use-search.ts\n│   └── use-theme.ts\n└── utils/                    # Utility hooks\n    └── use-websocket.ts\n```\n\n### Utilities Structure\n```\nlib/\n├── k8s/                      # Kubernetes-specific utilities\n│   ├── client.ts\n│   ├── ingress-stream.ts\n│   └── rbac.ts\n├── utils/                    # General utilities\n│   ├── ingress-transformer.ts\n│   ├── error-handler.ts\n│   └── url-builder.ts\n└── types/                    # Type definitions\n    ├── ingress.ts\n    └── k8s.ts\n```\n\n## Code Organization Principles\n\n### Single File Responsibility\n- Each file should have a single, well-defined purpose\n- Component files contain the component and related sub-components\n- Service files handle specific functionality\n- Hook files export related hooks\n- Utility files contain related helper functions\n\n### Module Dependencies\n- **Top-level imports**: Import from standard libraries first\n- **Internal imports**: Organized by directory structure\n- **No circular dependencies**: Maintain clear dependency hierarchy\n- **Shared utilities**: Create reusable utility modules for common functions\n\n### API Structure\n```\napp/\n├── api/\n│   ├── ingresses/\n│   │   └── route.ts          # Handles ingress data API\n│   └── [...path]/             # Catch-all for any additional API routes\n```\n\n## Build and Deployment Structure\n\n### Docker Multi-stage Build\n```\nDockerfile\n├── Base stage: Set up Node.js environment\n├── Dependencies stage: Install production dependencies\n├── Build stage: Build Next.js application\n└── Production stage: Copy build assets and run application\n```\n\n### Helm Chart Structure\n```\ncharts/k8s-ingress-dashboard/\n├── Chart.yaml                 # Chart metadata\n├── values.yaml                # Default configuration values\n├── values.schema.json         # Schema validation for values\n├── README.md                 # Chart documentation\n└── templates/                # Kubernetes resource templates\n    ├── _helpers.tpl          # Template helper functions\n    ├── deployment.yaml       # Application deployment\n    ├── service.yaml          # Service definition\n    ├── serviceaccount.yaml   # Service account\n    ├── role.yaml             # RBAC role\n    ├── rolebinding.yaml      # RBAC role binding\n    ├── clusterrole.yaml      # RBAC cluster role (if needed)\n    ├── clusterrolebinding.yaml # RBAC cluster role binding (if needed)\n    ├── ingress.yaml          # Ingress for dashboard access (optional)\n    ├── hpa.yaml             # Horizontal Pod Autoscaler (optional)\n    └── NOTES.txt            # Installation notes\n```\n\n## Testing Structure (if implemented)\n```\ntests/\n├── unit/                     # Unit tests\n│   ├── components/           # Component tests\n│   │   └── ingress-card.test.tsx\n│   ├── lib/                  # Library/utilities tests\n│   │   ├── k8s/\n│   │   └── utils/\n│   └── hooks/                # Hook tests\n│       └── use-search.test.ts\n├── integration/              # Integration tests\n│   └── api/\n│       └── ingresses.test.ts\n└── e2e/                      # End-to-end tests\n    └── dashboard.test.ts\n```\n\n## Documentation Structure\n```\ndocs/\n├── development/\n│   ├── setup.md             # Local development setup\n│   ├── architecture.md      # System architecture overview\n│   └── contributing.md      # Contribution guidelines\n├── deployment/\n│   ├── kubernetes.md        # Kubernetes deployment guide\n│   ├── configuration.md     # Configuration options\n│   └── troubleshooting.md   # Troubleshooting guide\n├── api/                     # API documentation\n│   └── reference.md         # API endpoints reference\n└── usage/                   # User guide\n    ├── quickstart.md        # Getting started\n    └── features.md          # Feature usage\n```\n\n## Configuration Files Structure\n- **`package.json`**: Dependencies, scripts, and project metadata\n- **`tsconfig.json`**: TypeScript compiler configuration\n- **`next.config.js`**: Next.js configuration\n- **`components.json`**: shadcn/ui configuration\n- **`.dockerignore`**: Files to exclude from Docker build\n- **`.gitignore`**: Files to exclude from Git\n- **`Dockerfile`**: Multi-stage Docker build configuration\n\n## Import/Export Patterns\n\n### Internal Module Imports\n```typescript\n// Prefer relative imports within the same domain\nimport { IngressCard } from '@/components/data-display/ingress-card';\nimport { useK8sData } from '@/hooks/data/use-k8s-data';\nimport { getIngresses } from '@/lib/k8s/client';\nimport { IngressData } from '@/types/ingress';\n```\n\n### Public API Exports\n- Create index.ts files to expose public APIs\n- Use barrel exports to simplify imports\n- Maintain clear boundaries between public and private APIs\n\n### Third-party Library Integration\n- Group third-party imports at the top\n- Create wrapper modules for complex third-party integrations\n- Maintain consistent usage patterns across the application\n\n## Serena Tool Integration Requirements\n\n### Project Navigation Protocol\n- When starting work on any task within this project, use Serena's symbolic code navigation tools to understand the structure\n- Call `mcp_serena_initial_instructions` at the beginning of each development session\n- Leverage `find_symbol`, `find_referencing_symbols`, and other symbolic tools to understand existing code patterns\n- Use `get_symbols_overview` to understand new files before modifying them\n\n### Implementation Verification\n- Before completing any implementation work, run the Serena verification protocol:\n  1. `mcp_serena_think_about_collected_information` - Verify understanding of requirements\n  2. `mcp_serena_think_about_task_adherence` - Verify implementation matches task requirements\n  3. `mcp_serena_think_about_whether_you_are_done` - Verify completeness of work\n- Always check existing code patterns and project conventions during implementation\n- Use diagnostic tools to verify code quality before completion",
  "fileStats": {
    "size": 11609,
    "lines": 262,
    "lastModified": "2025-11-12T15:23:01.410Z"
  },
  "comments": []
}