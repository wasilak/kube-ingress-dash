# Implementation Plan

- [x] 1. Set up Mantine framework and theme configuration
  - Install Mantine core packages (@mantine/core, @mantine/hooks, @mantine/notifications)
  - Install icon library (@tabler/icons-react)
  - Configure MantineProvider in src/app/layout.tsx
  - Create theme configuration file matching current design tokens (colors, spacing, fonts)
  - Set up CSS imports and verify Mantine styles load correctly
  - Test basic Mantine component rendering
  - _Requirements: 1.1, 1.5_

- [x] 2. Migrate core UI components to Mantine
  - [x] 2.1 Migrate Button component
    - Replace all Button imports from shadcn to Mantine
    - Update Button props to Mantine API (variant, size, etc.)
    - Test all button variants across the application
    - _Requirements: 1.1_
  - [x] 2.2 Migrate Badge component
    - Replace Badge imports with Mantine Badge
    - Update Badge props and variants
    - Verify visual consistency
    - _Requirements: 1.1_
  - [x] 2.3 Migrate Input and TextInput components
    - Replace Input with Mantine TextInput
    - Update SearchBar component to use Mantine TextInput
    - Test search functionality
    - _Requirements: 1.1_
  - [x] 2.4 Migrate Select component
    - Replace Select with Mantine Select
    - Update namespace filter to use Mantine Select
    - Add search capability to Select
    - Test dropdown behavior
    - _Requirements: 1.1_
  - [x] 2.5 Migrate Card component
    - Replace Card imports with Mantine Card
    - Update Card.Header, Card.Content, Card.Footer to Mantine equivalents
    - Verify card layout and styling
    - _Requirements: 1.1, 1.4_

- [x] 3. Refactor IngressCard component with Mantine
  - Update IngressCard to use Mantine Card component
  - Add details icon button (ActionIcon with IconInfoCircle)
  - Implement onDetailsClick callback prop
  - Update card layout with Mantine Stack and Group components
  - Maintain existing hosts and paths display
  - Update TLS lock icon styling
  - Test card rendering and interactions
  - _Requirements: 1.1, 6.1, 6.2, 6.3, 6.4_

- [x] 4. Remove shadcn/ui dependencies
  - Delete all files in src/components/ui directory
  - Remove @radix-ui/\* packages from package.json
  - Remove class-variance-authority from package.json
  - Remove cmdk from package.json
  - Update all remaining imports to use Mantine
  - Run npm install to clean up node_modules
  - Run build to verify no errors
  - _Requirements: 1.2, 1.3_

- [x] 5. Update application title in header
  - Locate title display in DashboardHeader component
  - Change "kube-ingress-dash" to "Kube Ingress Dash"
  - Verify title displays correctly
  - _Requirements: 4.1, 4.2_

- [x] 6. Implement grouping system
  - [x] 6.1 Create grouping types and utilities
    - Define GroupingMode type ('none' | 'namespace' | 'tls')
    - Create groupIngresses utility function
    - Implement logic for namespace grouping
    - Implement logic for TLS status grouping
    - Handle empty groups
    - Add sorting for groups
    - _Requirements: 5.2, 5.3, 5.4_
  - [x] 6.2 Create GroupingSelector component
    - Build component with Mantine Select
    - Add grouping mode options (None, Namespace, TLS Status)
    - Implement onChange handler
    - Style component for dashboard integration
    - _Requirements: 5.1_
  - [x] 6.3 Create GroupedIngressGrid component
    - Build component to render grouped sections
    - Display group headers with counts
    - Render ingress cards within each group
    - Use Mantine SimpleGrid for responsive layout
    - Handle empty groups display
    - Add smooth transitions between grouping modes
    - _Requirements: 5.5, 5.6, 5.7_
  - [x] 6.4 Integrate grouping into dashboard page
    - Add grouping state to dashboard page
    - Connect GroupingSelector to state
    - Replace IngressList with GroupedIngressGrid
    - Ensure grouping works with filters and search
    - Add URL persistence for grouping mode
    - Test grouping with various data sets
    - _Requirements: 5.8, 5.9, 5.10_

- [x] 7. Enhance type system for new features
  - Add yamlManifest field to IngressData interface
  - Create IngressDetailResponse type
  - Update KubernetesIngress type if needed
  - _Requirements: 8.1, 8.2, 8.3, 8.4_

- [x] 8. Implement YAML generation
  - Install js-yaml package
  - Create YAML generation utility
  - Convert IngressData to Kubernetes YAML format
  - Include all ingress spec details
  - Format YAML with proper indentation
  - Add YAML to ingress detail responses
  - _Requirements: 2.6_

- [x] 9. Create IngressDetailsModal component
  - [x] 9.1 Build modal shell and structure
    - Create IngressDetailsModal component file
    - Set up Mantine Modal with props (opened, onClose, ingress)
    - Configure modal size and scroll behavior
    - Add modal header with ingress name
    - Create section layout structure
    - _Requirements: 2.1, 2.10_
  - [x] 9.2 Implement main details section
    - Display ingress name, namespace, creation timestamp
    - Add status indicator with color coding
    - Add TLS badge if enabled
    - Display ingress class
    - Format timestamps for readability
    - _Requirements: 2.2_
  - [x] 9.3 Implement labels section
    - Create grid layout for key-value pairs
    - Display all labels from ingress
    - Add copy button for individual values
    - Handle empty labels state
    - _Requirements: 2.3_
  - [x] 9.4 Implement annotations section
    - Create grid layout for key-value pairs
    - Display all annotations from ingress
    - Add copy button for individual values
    - Add collapsible behavior for many annotations
    - Special formatting for known annotations
    - Handle empty annotations state
    - _Requirements: 2.4_
  - [x] 9.5 Implement ingress configuration section
    - Display hosts list with external link icons
    - Display paths with backend service information
    - Show load balancer status
    - Display rules breakdown
    - Format configuration for readability
    - _Requirements: 2.5_
  - [x] 9.6 Implement YAML manifest section
    - Install react-syntax-highlighter
    - Display YAML with syntax highlighting
    - Add copy to clipboard button
    - Implement copy functionality
    - Add collapsible behavior
    - Show line numbers
    - Handle YAML generation errors
    - _Requirements: 2.6, 2.7_

- [x] 10. Implement URL routing for modal state
  - [x] 10.1 Add URL parameter handling
    - Parse ingress parameter from URL query string
    - Extract namespace and name from parameter
    - Find matching ingress in data
    - Open modal if ingress found
    - _Requirements: 2.8, 9.2, 9.3_
  - [x] 10.2 Update URL when modal opens
    - Add ingress identifier to URL when modal opens
    - Use format: ?ingress={namespace}/{name}
    - Update browser history without page reload
    - Preserve other query parameters (grouping, filters)
    - _Requirements: 2.8, 9.1_
  - [x] 10.3 Clean URL when modal closes
    - Remove ingress parameter from URL on close
    - Update browser history
    - Preserve other query parameters
    - _Requirements: 9.4_
  - [x] 10.4 Handle invalid ingress URLs
    - Validate ingress identifier format
    - Show error notification for invalid identifiers
    - Show error notification for ingress not found
    - Clean up URL on error
    - Handle malformed URLs gracefully
    - _Requirements: 9.5_

- [x] 11. Integrate modal with dashboard
  - Add modal state to dashboard page (selectedIngress, modalOpened)
  - Pass onDetailsClick handler to IngressCard components
  - Render IngressDetailsModal component
  - Connect modal open/close handlers
  - Implement URL synchronization
  - Test modal opening from card click
  - Test modal opening from direct URL
  - Test modal closing and URL cleanup
  - _Requirements: 2.1, 2.8, 2.9, 6.2_

- [x] 12. Add performance optimizations
  - [x] 12.1 Implement component memoization
    - Wrap IngressCard in React.memo with custom comparison
    - Memoize GroupedIngressGrid sections
    - Use useMemo for grouping calculations
    - Use useCallback for event handlers
    - _Requirements: 10.4_
  - [x] 12.2 Implement virtualization for large lists
    - Install @tanstack/react-virtual
    - Add virtualization to GroupedIngressGrid when count > 100
    - Configure virtual scrolling with estimated card height
    - Test with large data sets
    - _Requirements: 10.5_

- [x] 13. Add loading states and error handling
  - Add loading state for YAML generation
  - Implement error boundaries for modal sections
  - Add error messages for failed operations
  - Add retry mechanisms where appropriate
  - Test error scenarios
  - _Requirements: 7.5, 7.6_

- [x] 14. Implement settings screen with filter exclusions
  - [x] 14.1 Create settings page route and layout
    - Create /settings route using Next.js App Router
    - Add settings page component with Mantine layout
    - Add "Settings" text link in dashboard header (right side of app title)
    - Make app title clickable link to main dashboard view
    - Use Mantine Container for page layout
    - _Requirements: TBD_
  - [x] 14.2 Implement settings storage utilities
    - Create localStorage utility functions for settings persistence
    - Define settings data structure (excludedLabels, excludedNamespaces, excludedAnnotations)
    - Implement getSettings and saveSettings functions
    - Add default settings initialization
    - Handle localStorage errors gracefully
    - _Requirements: TBD_
  - [x] 14.3 Create settings tabs component
    - Use Mantine Tabs component with three tabs
    - Tab 1: "Labels" - for label exclusions
    - Tab 2: "Namespaces" - for namespace exclusions
    - Tab 3: "Annotations" - for annotation exclusions
    - Configure tabs with proper styling and icons
    - _Requirements: TBD_
  - [x] 14.4 Implement label exclusion settings
    - Create MultiSelect component for label selection
    - Fetch all available labels from ingresses
    - Display all labels with all selected by default
    - Save changes to localStorage on selection change
    - Show count of excluded labels
    - _Requirements: TBD_
  - [x] 14.5 Implement namespace exclusion settings
    - Create MultiSelect component for namespace selection
    - Fetch all available namespaces from ingresses
    - Display all namespaces with all selected by default
    - Save changes to localStorage on selection change
    - Show count of excluded namespaces
    - _Requirements: TBD_
  - [x] 14.6 Implement annotation exclusion settings
    - Create MultiSelect component for annotation selection
    - Fetch all available annotations from ingresses
    - Display all annotations with all selected by default
    - Save changes to localStorage on selection change
    - Show count of excluded annotations
    - _Requirements: TBD_
  - [x] 14.7 Update main dashboard filters to respect settings
    - Load settings from localStorage on dashboard mount
    - Filter out excluded labels from label filter options
    - Filter out excluded namespaces from namespace filter options
    - Filter out excluded annotations from annotation filter options
    - Ensure filters update when settings change
    - _Requirements: TBD_
  - [x] 14.8 Add settings context provider
    - Create React Context for settings state
    - Provide settings and updateSettings functions
    - Wrap application with SettingsProvider
    - Enable settings access across components
    - Handle settings synchronization across tabs
    - _Requirements: TBD_

- [ ] 15. Implement accessibility features
  - Add ARIA labels to all icon buttons
  - Implement keyboard navigation for modal
  - Add focus trap within modal
  - Ensure focus returns to trigger on close
  - Test with screen readers
  - Verify keyboard-only navigation works
  - Check color contrast ratios
  - _Requirements: All requirements (accessibility is cross-cutting)_

- [x] 16. Add animations and transitions
  - Add smooth transitions for grouping mode changes
  - Add modal open/close animations
  - Add loading state animations
  - Add hover effects on interactive elements
  - Keep animations subtle and performant
  - _Requirements: 1.4_

- [x] 17. Update documentation
  - Update README with new features
  - Document grouping functionality
  - Document modal navigation and URL sharing
  - Document settings screen and filter exclusions
  - Remove any md documents outside of docs-site (docusaurus) from the whole codebase
  - _Requirements: All requirements_

- [x] 18. Final testing and polish
  - Fix any remaining bugs
  - _Requirements: All requirements_

- [x] 19. Create Helm chart values schema
  - [x] 19.1 Create values.schema.json file
    - Create values.schema.json in the Helm chart directory
    - Define JSON schema structure following JSON Schema Draft 7 specification
    - Add schema metadata ($schema, title, description)
    - _Requirements: TBD_
  - [x] 19.2 Define schema for all configuration values
    - Document all properties from values.yaml
    - Add type definitions for each property (string, number, boolean, object, array)
    - Define required vs optional properties
    - Add property descriptions for user guidance
    - _Requirements: TBD_
  - [x] 19.3 Add validation rules and constraints
    - Add minimum/maximum values for numeric properties
    - Add pattern validation for string properties (e.g., regex for URLs, ports)
    - Add enum constraints for properties with fixed options
    - Define default values where applicable
    - Add examples for complex properties
    - _Requirements: TBD_
  - [x] 19.4 Document nested configuration objects
    - Define schemas for nested objects (ingress, service, resources, etc.)
    - Add additionalProperties constraints
    - Document array item schemas
    - Ensure proper nesting and references
    - _Requirements: TBD_
  - [x] 19.5 Test schema validation
    - Validate values.yaml against values.schema.json
    - Test with various configuration scenarios
    - Verify schema works with Helm and Artifact Hub
    - Fix any validation errors
    - Add schema validation to CI/CD pipeline
    - _Requirements: TBD_
  - [x] 19.6 Add schema documentation
    - Document schema usage in chart README
    - Add examples of valid configurations
    - Document how to validate locally
    - Prepare for Artifact Hub publication
    - _Requirements: TBD_

- [x] 15. Implement Mantine Spotlight for navigation
  - [x] 15.1 Install and configure Mantine Spotlight
    - Install @mantine/spotlight package
    - Add SpotlightProvider to app layout
    - Configure keyboard shortcut (Cmd+K / Ctrl+K)
    - _Requirements: TBD_

  - [x] 15.2 Create navigation actions
    - Define spotlight actions for navigation
    - Action: "Go to Dashboard" → navigate to "/"
    - Action: "Go to Settings - Namespaces" → navigate to "/settings/namespaces"
    - Action: "Go to Settings - Labels" → navigate to "/settings/labels"
    - Action: "Go to Settings - Annotations" → navigate to "/settings/annotations"
    - Add appropriate icons for each action
    - _Requirements: TBD_

  - [x] 15.3 Style spotlight to match application theme
    - Configure spotlight colors to use indigo theme
    - Ensure proper dark mode support
    - Match border and highlight colors with existing UI
    - _Requirements: TBD_
